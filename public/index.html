<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>XenOS Scramjet Fixed</title>
<link rel="shortcut icon" href="favicon.webp">

<!-- Scramjet scripts -->
<script src="/scram/scramjet.all.js"></script>
<script src="/baremux/index.js"></script>
<script src="register-sw.js" defer></script>
<script src="search.js" defer></script>
<script src="index.js" defer></script>

<style>
* { margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI',sans-serif; }
html, body { height:100%; overflow:hidden; background:url('https://images.unsplash.com/photo-1446776811953-b23d57bd21aa?q=80&w=1974&auto=format&fit=crop') center/cover no-repeat; }

/* LOCK SCREEN */
#lockscreen{ position:absolute; inset:0; background:rgba(0,0,0,0.85); display:flex; flex-direction:column; justify-content:center; align-items:center; color:white; z-index:9999; text-align:center; }
#lockscreen input{ padding:10px; margin:10px; border-radius:6px; border:none; outline:none; width:220px; text-align:center; }
#lockscreen button{ padding:10px 20px; margin-top:10px; border:none; border-radius:6px; cursor:pointer; background:white; color:black; }

/* DESKTOP */
#desktop{ position:absolute; inset:0; padding:20px; }

/* DESKTOP ICONS */
.desktop-icon{ width:80px; text-align:center; cursor:pointer; margin:10px; }
.desktop-icon img{ width:48px; height:48px; margin-bottom:5px; }

/* TASKBAR */
#taskbar{ position:absolute; bottom:0; left:0; right:0; height:50px; background:rgba(20,20,40,0.85); display:flex; justify-content:space-between; align-items:center; padding:0 15px; backdrop-filter:blur(8px); color:white; }
#toolbar-left{ display:flex; align-items:center; gap:10px; }
#toolbar-right{ display:flex; align-items:center; gap:10px; }
#start{ padding:8px 14px; background:rgba(255,255,255,0.1); border-radius:6px; cursor:pointer; }
#clock,#date{ cursor:pointer; font-size:0.9rem; }

/* START MENU */
#start-menu{ display:none; position:absolute; bottom:50px; left:10px; background:#1e1e2f; border-radius:10px; padding:15px; width:220px; }
.menu-item{ padding:8px; cursor:pointer; }
.menu-item:hover{ background:#27293d; }

/* WINDOWS */
.window{ position:absolute; width:800px; height:500px; background:#111; border-radius:12px; overflow:hidden; box-shadow:0 0 30px rgba(0,0,0,0.7); display:flex; flex-direction:column; z-index:1; }
.window-header{ height:40px; background:#1c1c2e; display:flex; justify-content:space-between; align-items:center; padding:0 10px; cursor:move; }
.window-controls{ display:flex; gap:8px; }
.control{ width:12px; height:12px; border-radius:50%; cursor:pointer; }
.close{ background:#ff5f56; } .min{ background:#ffbd2e; } .max{ background:#27c93f; }
.window iframe{ flex:1; border:none; }
.resize{ width:15px; height:15px; position:absolute; right:0; bottom:0; cursor:nwse-resize; }

/* CALENDAR */
#calendar{ display:none; position:absolute; bottom:50px; right:10px; background:#1e1e2f; color:white; padding:10px; border-radius:10px; width:220px; }
#calendar table{ width:100%; text-align:center; border-collapse:collapse; }
#calendar th{ padding:5px; }
#calendar td{ padding:8px; cursor:pointer; }
#calendar td:hover{ background:#27293d; border-radius:6px; }

/* SETTINGS PANEL */
#settings-panel{ display:none; position:absolute; bottom:50px; right:10px; width:250px; background:#1e1e2f; color:white; padding:15px; border-radius:10px; }
#settings-panel h3{ margin-bottom:10px; }
#settings-panel button{ margin-top:10px; padding:6px 12px; border-radius:6px; border:none; cursor:pointer; background:#27293d; color:white; }
</style>
</head>
<body>

<!-- LOCK SCREEN -->
<div id="lockscreen">
  <h1>Welcome to XenOS</h1>
  <div id="account-setup" style="display:block;">
    <input type="text" id="username" placeholder="Username">
    <input type="password" id="password" placeholder="Password">
    <button id="create-account">Create Account</button>
  </div>
  <div id="login" style="display:none;">
    <input type="password" id="unlock-password" placeholder="Enter Password">
    <button id="unlock-btn">Unlock</button>
  </div>
</div>

<!-- DESKTOP -->
<div id="desktop"></div>

<!-- TASKBAR -->
<div id="taskbar">
  <div id="toolbar-left"><div id="start">â˜° Start</div></div>
  <div id="toolbar-right"><div id="date">--/--/----</div><div id="clock">--:--:--</div></div>
</div>

<!-- START MENU -->
<div id="start-menu">
  <div class="menu-item" onclick="launchApp('https://youtube.com')">YouTube</div>
  <div class="menu-item" onclick="launchApp('https://tiktok.com')">TikTok</div>
  <div class="menu-item" onclick="launchApp('https://google.com')">Google</div>
  <div class="menu-item" onclick="showSettings()">Settings</div>
</div>

<!-- CALENDAR -->
<div id="calendar"></div>

<!-- SETTINGS PANEL -->
<div id="settings-panel">
  <h3>System Settings</h3>
  <label>Wallpaper URL:</label>
  <input type="text" id="wallpaper-input" placeholder="Enter image URL" style="width:100%; margin-bottom:8px;">
  <button id="apply-wallpaper">Apply Wallpaper</button>
  <button onclick="logout()">Logout</button>
</div>

<script>
const desktop=document.getElementById('desktop');
let zIndex=1;
const SCRAMJET_PROXY = "https://scramjet-app-n46z.onrender.com/?url=";

/* CLOCK & DATE */
function updateTime(){
  const now=new Date();
  document.getElementById('clock').innerText=now.toLocaleTimeString();
  document.getElementById('date').innerText=now.toLocaleDateString();
}
setInterval(updateTime,1000); updateTime();

/* CALENDAR */
const calendar=document.getElementById('calendar');
document.getElementById('date').onclick=()=>{
  calendar.style.display = calendar.style.display==='block'?'none':'block';
  generateCalendar();
};
function generateCalendar(){
  const now=new Date();
  const month=now.getMonth();
  const year=now.getFullYear();
  const firstDay=new Date(year,month,1).getDay();
  const lastDate=new Date(year,month+1,0).getDate();
  let html='<table><tr><th>Su</th><th>Mo</th><th>Tu</th><th>We</th><th>Th</th><th>Fr</th><th>Sa</th></tr><tr>';
  for(let i=0;i<firstDay;i++) html+='<td></td>';
  for(let d=1; d<=lastDate; d++){
    if((firstDay+d-1)%7===0 && d!==1) html+='</tr><tr>';
    html+='<td>'+d+'</td>';
  }
  html+='</tr></table>';
  calendar.innerHTML=html;
}

/* SETTINGS */
const settingsPanel=document.getElementById('settings-panel');
function showSettings(){settingsPanel.style.display='block';}
document.getElementById('apply-wallpaper').onclick=()=>{
  const url=document.getElementById('wallpaper-input').value;
  if(url) document.body.style.background=`url('${url}') center/cover no-repeat`;
};
function logout(){localStorage.clear(); location.reload();}

/* LOCK SCREEN */
const accountSetup=document.getElementById('account-setup');
const loginDiv=document.getElementById('login');
const lockscreen=document.getElementById('lockscreen');
document.getElementById('create-account').onclick=()=>{
  const u=document.getElementById('username').value;
  const p=document.getElementById('password').value;
  if(u && p){ localStorage.setItem('xenos_username',u); localStorage.setItem('xenos_password',p); accountSetup.style.display='none'; loginDiv.style.display='block'; }
};
document.getElementById('unlock-btn').onclick=()=>{
  const p=document.getElementById('unlock-password').value;
  if(p===localStorage.getItem('xenos_password')) lockscreen.style.display='none';
  else alert('Wrong password!');
};

/* START MENU */
document.getElementById('start').onclick=()=>{
  const menu=document.getElementById('start-menu');
  menu.style.display = menu.style.display==='block'?'none':'block';
};

/* CREATE WINDOWS WITH SCRAMJET PROXY */
function launchApp(url){
  const win=document.createElement('div');
  win.className='window';
  win.style.top='100px'; win.style.left='150px'; win.style.zIndex=zIndex++;

  // window header
  const header=document.createElement('div'); header.className='window-header';
  header.innerHTML=`<span>${url}</span><div class="window-controls">
    <div class="control min"></div><div class="control max"></div><div class="control close"></div>
  </div>`;
  win.appendChild(header);

  // iframe loads via Scramjet proxy
  const iframe=document.createElement('iframe');
  iframe.src = SCRAMJET_PROXY + encodeURIComponent(url);
  win.appendChild(iframe);

  const resizeHandle=document.createElement('div'); resizeHandle.className='resize';
  win.appendChild(resizeHandle);
  desktop.appendChild(win);

  // Drag & resize
  drag(win); resize(win);

  // Window buttons
  header.querySelector('.close').onclick=()=>win.remove();
  header.querySelector('.min').onclick=()=>win.style.display='none';
  header.querySelector('.max').onclick=()=>{win.style.top='0'; win.style.left='0'; win.style.width='100%'; win.style.height='calc(100% - 50px)';};
  win.onclick=()=>win.style.zIndex=zIndex++;
}

/* DRAGGING */
function drag(win){
  const header=win.querySelector('.window-header');
  let offsetX,offsetY,dragging=false;
  header.onmousedown=e=>{dragging=true; offsetX=e.clientX-win.offsetLeft; offsetY=e.clientY-win.offsetTop;};
  document.onmousemove=e=>{if(dragging){win.style.left=e.clientX-offsetX+'px'; win.style.top=e.clientY-offsetY+'px';}};
  document.onmouseup=()=>dragging=false;
}

/* RESIZE */
function resize(win){
  const handle=win.querySelector('.resize'); let resizing=false;
  handle.onmousedown=e=>{resizing=true; e.stopPropagation();};
  document.onmousemove=e=>{if(resizing){win.style.width=e.clientX-win.offsetLeft+'px'; win.style.height=e.clientY-win.offsetTop+'px';}};
  document.onmouseup=()=>resizing=false;
}

/* DESKTOP ICONS */
function addIcon(name,url){
  const icon=document.createElement('div'); icon.className='desktop-icon';
  icon.innerHTML=`<img src="https://cdn-icons-png.flaticon.com/512/888/888879.png"><div>${name}</div>`;
  icon.onclick=()=>launchApp(url);
  desktop.appendChild(icon);
}
addIcon('YouTube','https://youtube.com');
addIcon('TikTok','https://tiktok.com');
addIcon('Google','https://google.com');
</script>

</body>
</html>
