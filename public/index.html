<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>XenOS Browser</title>

<link rel="shortcut icon" href="favicon.webp" />

<style>
body, html {
  margin:0; padding:0; height:100%;
  font-family:'Segoe UI', sans-serif;
  background: linear-gradient(135deg,#121212,#1c1c1c);
  background-image: url('moon-bg.jpg'); /* upload to public/ folder */
  background-size: cover;
  background-position: center;
  overflow:hidden;
  color:#fff;
}

/* Desktop */
#desktop {
  position:relative;
  width:100%; height:100%;
}

/* Taskbar */
#taskbar {
  position:absolute; bottom:0; left:0; width:100%;
  height:40px; background: rgba(0,0,0,0.7);
  display:flex; align-items:center; justify-content:space-between;
  padding:0 10px;
  font-size:0.85rem;
}
#start-button { cursor:pointer; padding:5px 10px; background:rgba(255,255,255,0.1); border-radius:4px; }
#clock { margin-right:10px; }

/* Windows */
.window {
  position:absolute;
  border-radius:6px;
  overflow:hidden;
  box-shadow:0 0 12px rgba(0,0,0,0.5);
  background:#222;
  resize: both;
  min-width:300px; min-height:200px;
}

.window-header {
  background: rgba(50,50,50,0.9);
  padding:5px 10px;
  cursor:move;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.window-header span { user-select:none; }
.window-close { cursor:pointer; padding:0 5px; }
.window iframe {
  width:100%;
  height:calc(100% - 30px);
  border:none;
}

/* Start menu */
#start-menu {
  position:absolute; bottom:40px; left:10px;
  width:220px;
  background: rgba(30,30,30,0.95);
  border-radius:6px;
  display:none;
  flex-direction:column;
  padding:10px;
}
.start-menu-item { padding:6px 10px; cursor:pointer; border-radius:4px; transition:0.2s; }
.start-menu-item:hover { background: rgba(255,255,255,0.1); }

/* Lock screen */
#lock-screen {
  position:absolute; top:0; left:0; width:100%; height:100%;
  background: linear-gradient(135deg,#121212,#1c1c1c);
  background-image: url('moon-bg.jpg');
  background-size: cover;
  background-position: center;
  display:flex; justify-content:center; align-items:center;
  flex-direction:column;
  color:#fff;
  font-size:1.2rem;
}
#lock-screen input {
  padding:8px 12px;
  border-radius:6px;
  border:none;
  margin-top:10px;
  outline:none;
}
#lock-screen button {
  margin-top:10px;
  padding:6px 12px;
  border-radius:6px;
  border:none;
  cursor:pointer;
}
</style>
</head>
<body>

<div id="desktop"></div>

<!-- Taskbar -->
<div id="taskbar">
  <div id="start-button">Start</div>
  <div id="clock"></div>
</div>

<!-- Start menu -->
<div id="start-menu">
  <div class="start-menu-item" onclick="openApp('youtube')">YouTube</div>
  <div class="start-menu-item" onclick="openApp('instagram')">Instagram</div>
  <div class="start-menu-item" onclick="openApp('terminal')">Terminal</div>
  <div class="start-menu-item" onclick="openApp('settings')">Settings</div>
</div>

<!-- Lock screen -->
<div id="lock-screen">
  <div>Enter Password to Unlock</div>
  <input type="password" id="unlock-password" placeholder="Password"/>
  <button onclick="unlockScreen()">Unlock</button>
</div>

<script>
let startMenuVisible = false;
const startButton = document.getElementById('start-button');
const startMenu = document.getElementById('start-menu');
const desktop = document.getElementById('desktop');
const lockScreen = document.getElementById('lock-screen');
const password = "1234"; // simple password

// Toggle Start Menu
startButton.addEventListener('click', () => {
  startMenuVisible = !startMenuVisible;
  startMenu.style.display = startMenuVisible ? 'flex' : 'none';
});

// Clock
function updateClock() {
  const now = new Date();
  document.getElementById('clock').innerText = now.toLocaleTimeString();
}
setInterval(updateClock, 1000);
updateClock();

// Unlock screen
function unlockScreen() {
  const val = document.getElementById('unlock-password').value;
  if(val === password) lockScreen.style.display = 'none';
  else alert('Wrong password');
}

// Make windows draggable
function dragElement(el) {
  let pos1=0,pos2=0,pos3=0,pos4=0;
  const header = el.querySelector(".window-header");
  (header?header:el).onmousedown = function(e){
    e = e||window.event;
    e.preventDefault();
    pos3 = e.clientX;
    pos4 = e.clientY;
    document.onmouseup = closeDrag;
    document.onmousemove = drag;
  };
  function drag(e){
    e = e||window.event;
    e.preventDefault();
    pos1 = pos3 - e.clientX;
    pos2 = pos4 - e.clientY;
    pos3 = e.clientX;
    pos4 = e.clientY;
    el.style.top = (el.offsetTop - pos2)+"px";
    el.style.left = (el.offsetLeft - pos1)+"px";
  }
  function closeDrag(){
    document.onmouseup = null;
    document.onmousemove = null;
  }
}

// Open App
function openApp(name){
  let url = "";
  if(name==="youtube") {
      let videoId = prompt("Enter YouTube video ID or leave blank for default:");
      if(!videoId) videoId="dQw4w9WgXcQ"; // default video
      url=`/wisp-proxy?url=https://www.youtube.com/embed/${videoId}`;
  }
  if(name==="instagram") url="/wisp-proxy?url=https://www.instagram.com";

  if(name==="terminal") url="about:blank";
  if(name==="settings") url="about:blank";

  const win = document.createElement('div');
  win.className="window";
  win.style.top="50px";
  win.style.left="50px";
  win.style.width="800px";
  win.style.height="500px";

  win.innerHTML = `
    <div class="window-header">
      <span>${name}</span>
      <span class="window-close" onclick="this.parentElement.parentElement.remove()">âœ•</span>
    </div>
    <iframe src="${url}"></iframe>
  `;
  desktop.appendChild(win);
  dragElement(win);
}
</script>

</body>
</html>
